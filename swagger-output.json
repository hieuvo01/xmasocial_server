{
  "openapi": "3.0.0",
  "info": {
    "title": "XmasOcial API Docs - Ultimate Edition",
    "version": "3.0.0",
    "description": "Tài liệu API đầy đủ cho toàn bộ hệ thống XmasOcial"
  },
  "servers": [
    { "url": "http://localhost:3000", "description": "Local Development" },
    { "url": "https://xmasocial-server.onrender.com", "description": "Production Server" }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": { "type": "http", "scheme": "bearer", "bearerFormat": "JWT" }
    }
  },
  "paths": {
    "/api/auth/register": {
      "post": {
        "tags": ["1. Authentication"],
        "summary": "Đăng ký tài khoản",
        "requestBody": {
          "content": { "application/json": { "schema": { "type": "object", "properties": { "email": { "type": "string" }, "password": { "type": "string" }, "name": { "type": "string" } } } } }
        },
        "responses": { "201": { "description": "Created" } }
      }
    },
    "/api/auth/login": {
      "post": {
        "tags": ["1. Authentication"],
        "summary": "Đăng nhập",
        "requestBody": {
          "content": { "application/json": { "schema": { "type": "object", "properties": { "email": { "type": "string" }, "password": { "type": "string" } } } } }
        },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/users/profile": {
      "get": {
        "tags": ["2. Users & Profile"],
        "summary": "Lấy Profile cá nhân",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      },
      "put": {
        "tags": ["2. Users & Profile"],
        "summary": "Cập nhật Profile",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "content": { "application/json": { "schema": { "type": "object", "properties": { "displayName": { "type": "string" }, "bio": { "type": "string" } } } } }
        },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/users/profile/avatar": {
      "put": {
        "tags": ["2. Users & Profile"],
        "summary": "Cập nhật Avatar (Direct Cloudinary Link)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "content": { "application/json": { "schema": { "type": "object", "properties": { "avatarUrl": { "type": "string" } } } } }
        },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/users/2fa/generate": {
      "post": {
        "tags": ["2. Users & Profile"],
        "summary": "Tạo mã 2FA",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/users/admin/stats": {
      "get": {
        "tags": ["11. Admin & Moderator"],
        "summary": "Thống kê Dashboard",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/posts": {
      "get": {
        "tags": ["3. Posts"],
        "summary": "Lấy danh sách bài viết Newsfeed",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      },
      "post": {
        "tags": ["3. Posts"],
        "summary": "Tạo bài viết mới (Multipart/Array)",
        "security": [{ "bearerAuth": [] }],
        "responses": { "201": { "description": "Created" } }
      }
    },
    "/api/posts/create-direct": {
      "post": {
        "tags": ["3. Posts"],
        "summary": "Tạo bài viết (Link Cloudinary)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "content": { "application/json": { "schema": { "type": "object", "properties": { "content": { "type": "string" }, "mediaUrls": { "type": "array", "items": { "type": "string" } } } } } }
        },
        "responses": { "201": { "description": "Created" } }
      }
    },
    "/api/comments/{postId}/comments": {
      "get": {
        "tags": ["4. Comments"],
        "summary": "Lấy comment của bài viết",
        "parameters": [{ "name": "postId", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "OK" } }
      },
      "post": {
        "tags": ["4. Comments"],
        "summary": "Thêm comment mới",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "postId", "in": "path", "required": true, "schema": { "type": "string" } }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "text": { "type": "string" } } } } } },
        "responses": { "201": { "description": "Created" } }
      }
    },
    "/api/friends/send-request/{userId}": {
      "post": {
        "tags": ["5. Friends"],
        "summary": "Gửi lời mời kết bạn",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "userId", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "201": { "description": "Sent" } }
      }
    },
    "/api/friends/unfriend/{friendId}": {
      "post": {
        "tags": ["5. Friends"],
        "summary": "Hủy kết bạn",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "friendId", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/conversations": {
      "get": {
        "tags": ["6. Messenger"],
        "summary": "Lấy danh sách Inbox",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      },
      "post": {
        "tags": ["6. Messenger"],
        "summary": "Tạo/Lấy cuộc hội thoại",
        "security": [{ "bearerAuth": [] }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "targetId": { "type": "string" } } } } } },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/conversations/{id}/messages": {
      "get": {
        "tags": ["6. Messenger"],
        "summary": "Lấy tin nhắn trong hội thoại",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }],
        "responses": { "200": { "description": "OK" } }
      },
      "post": {
        "tags": ["6. Messenger"],
        "summary": "Gửi tin nhắn (Text/Cloudinary)",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "content": { "type": "string" }, "type": { "type": "string" }, "replyTo": { "type": "string" } } } } } },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/stories/feed": {
      "get": {
        "tags": ["7. Stories"],
        "summary": "Lấy bảng tin Story",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/stories/create-direct": {
      "post": {
        "tags": ["7. Stories"],
        "summary": "Tạo Story Media (Direct)",
        "security": [{ "bearerAuth": [] }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "mediaUrl": { "type": "string" }, "mediaType": { "type": "string" } } } } } },
        "responses": { "201": { "description": "OK" } }
      }
    },
    "/api/reels": {
      "get": {
        "tags": ["8. Reels"],
        "summary": "Lấy Reels Feed",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/ai/chat": {
      "post": {
        "tags": ["9. AI Assistant"],
        "summary": "Chat với AI",
        "security": [{ "bearerAuth": [] }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "message": { "type": "string" }, "character": { "type": "object" }, "history": { "type": "array", "items": { "type": "object" } } } } } } },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/games/submit-score": {
      "post": {
        "tags": ["10. Games Engine"],
        "summary": "Nộp điểm cao",
        "security": [{ "bearerAuth": [] }],
        "requestBody": { "content": { "application/json": { "schema": { "type": "object", "properties": { "gameId": { "type": "string" }, "score": { "type": "number" } } } } } },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/api/notifications": {
      "get": {
        "tags": ["12. Notifications"],
        "summary": "Lấy thông báo",
        "security": [{ "bearerAuth": [] }],
        "responses": { "200": { "description": "OK" } }
      }
    }
  }
}